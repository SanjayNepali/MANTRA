{% extends 'base.html' %}
{% load static %}

{% block title %}Celebrity Dashboard - MANTRA{% endblock %}

{% block extra_css %}
<style>
/* Dashboard-specific styles only - Don't override navbar */
.celebrity-dashboard-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0;
}

/* Welcome Section */
.dashboard-welcome {
    background: linear-gradient(135deg, var(--sage-green) 0%, var(--pink) 100%);
    border-radius: 20px;
    padding: 2rem;
    margin-bottom: 2rem;
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1.5rem;
}

.welcome-content h1 {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    color: white;
}

.welcome-content p {
    opacity: 0.9;
    margin: 0;
}

.welcome-stats {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.stat-pill {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
}

.stat-pill i {
    font-size: 1.5rem;
}

/* Quick Actions */
.quick-actions {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.quick-actions .action-card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    text-decoration: none;
    color: var(--brown);
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.quick-actions .action-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
}

.quick-actions .action-card i {
    font-size: 2rem;
    color: var(--sage-green);
}

.quick-actions .action-card span {
    font-weight: 600;
    font-size: 1rem;
}

/* KYC Verification Status */
.kyc-status-panel {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.kyc-status-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.kyc-status-header h3 {
    margin: 0;
    color: var(--brown);
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.kyc-status-badge {
    padding: 0.5rem 1rem;
    border-radius: 25px;
    font-weight: 600;
    font-size: 0.9rem;
}

.kyc-pending {
    background: rgba(255, 193, 7, 0.2);
    color: #ffc107;
}

.kyc-approved {
    background: rgba(40, 167, 69, 0.2);
    color: #28a745;
}

.kyc-rejected {
    background: rgba(220, 53, 69, 0.2);
    color: #dc3545;
}

.kyc-not-submitted {
    background: rgba(108, 117, 125, 0.2);
    color: #6c757d;
}

.kyc-resubmission {
    background: rgba(255, 193, 7, 0.2);
    color: #ffc107;
    border: 2px solid #ffc107;
}

.kyc-content {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.kyc-message {
    padding: 1rem;
    border-radius: 8px;
    background: var(--bg-light);
    border-left: 4px solid;
}

.kyc-message.info {
    border-left-color: #17a2b8;
}

.kyc-message.warning {
    border-left-color: #ffc107;
}

.kyc-message.success {
    border-left-color: #28a745;
}

.kyc-message.danger {
    border-left-color: #dc3545;
}

.kyc-remarks {
    background: #fff3cd;
    padding: 1rem;
    border-radius: 8px;
    border-left: 4px solid #ffc107;
    margin-top: 1rem;
}

.kyc-remarks h4 {
    margin: 0 0 0.5rem 0;
    color: #856404;
}

.kyc-actions {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
    flex-wrap: wrap;
}

.kyc-actions .btn {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

/* Dashboard Grid */
.dashboard-grid {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 2rem;
    margin-bottom: 2rem;
}

.dashboard-main,
.dashboard-sidebar {
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

/* Section Card */
.section-card {
    background: white;
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
}

.section-header h2,
.section-header h3 {
    font-size: 1.4rem;
    color: var(--brown);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 0;
}

.section-header h3 {
    font-size: 1.2rem;
}

.section-header .btn-link {
    color: var(--sage-green);
    text-decoration: none;
    font-weight: 600;
    transition: color 0.3s ease;
    font-size: 0.9rem;
}

.section-header .btn-link:hover {
    color: var(--pink);
}

/* Stats Grid */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.stat-card {
    display: flex;
    gap: 1rem;
    align-items: center;
    padding: 1rem;
    border-radius: 12px;
    background: var(--pink-light);
    transition: transform 0.3s ease;
}

.stat-card:hover {
    transform: translateY(-3px);
}

.stat-icon {
    width: 50px;
    height: 50px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    color: white;
    flex-shrink: 0;
}

.stat-icon.followers {
    background: var(--sage-green);
}

.stat-icon.views {
    background: var(--pink);
}

.stat-icon.engagement {
    background: var(--brown);
}

.stat-icon.posts {
    background: var(--sage-dark);
}

.stat-info h3 {
    font-size: 1.8rem;
    margin: 0;
    color: var(--brown);
}

.stat-info p {
    margin: 0;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.stat-change {
    font-size: 0.8rem;
    color: var(--text-muted);
}

.stat-change.positive {
    color: var(--sage-green);
}

/* Posts List */
.posts-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.post-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border-radius: 10px;
    border: 1px solid var(--border);
    transition: all 0.3s ease;
}

.post-item:hover {
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.post-content p {
    margin: 0 0 0.5rem 0;
    color: var(--text-primary);
}

.post-time {
    font-size: 0.85rem;
    color: var(--text-secondary);
}

.post-stats {
    display: flex;
    gap: 1rem;
    color: var(--text-secondary);
}

.post-stats span {
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

/* Events List */
.events-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.event-item {
    display: flex;
    gap: 1rem;
    align-items: center;
    padding: 1rem;
    border-radius: 10px;
    border: 1px solid var(--border);
    transition: background 0.3s ease;
}

.event-item:hover {
    background: var(--sage-light);
}

.event-icon {
    width: 45px;
    height: 45px;
    border-radius: 10px;
    background: var(--sage-light);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.event-icon i {
    font-size: 1.5rem;
    color: var(--sage-green);
}

.event-info {
    flex: 1;
}

.event-info h4 {
    margin: 0;
    font-size: 0.95rem;
    color: var(--brown);
}

.event-info p {
    margin: 0.25rem 0;
    font-size: 0.85rem;
    color: var(--text-secondary);
}

/* Filter Tabs */
.filter-tabs {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    border-bottom: 2px solid var(--border);
    padding-bottom: 0.5rem;
}

.filter-tab {
    padding: 0.5rem 1rem;
    border-radius: 8px 8px 0 0;
    text-decoration: none;
    color: var(--text-secondary);
    font-weight: 600;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.filter-tab:hover {
    background: var(--sage-light);
    color: var(--sage-green);
}

.filter-tab.active {
    background: linear-gradient(135deg, var(--pink) 0%, var(--sage-green) 100%);
    color: white;
}

.filter-tab i {
    font-size: 1.1rem;
}

/* Fan Posts List */
.fan-posts-list {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    padding: 1.5rem;
}

.fan-post-item {
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 1rem;
    transition: all 0.3s ease;
}

.fan-post-item:hover {
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
}

.post-author {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.author-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    flex-shrink: 0;
}

.author-info {
    flex: 1;
}

.author-info strong a {
    color: var(--brown);
    text-decoration: none;
    font-weight: 600;
}

.author-info strong a:hover {
    color: var(--pink);
}

.author-info .post-time {
    display: block;
    font-size: 0.8rem;
    color: var(--text-secondary);
}

.fan-post-item .post-content {
    margin-bottom: 1rem;
}

.fan-post-item .post-content p {
    margin: 0 0 0.75rem 0;
    color: var(--text-primary);
    line-height: 1.6;
}

.fan-post-item .post-image {
    width: 100%;
    max-height: 300px;
    object-fit: cover;
    border-radius: 8px;
}

.post-actions {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding-top: 0.75rem;
    border-top: 1px solid var(--border);
}

.post-action-btn {
    padding: 0.5rem 1rem;
    background: var(--sage-light);
    color: var(--sage-green);
    text-decoration: none;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.85rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    transition: all 0.3s ease;
}

.post-action-btn:hover {
    background: var(--sage-green);
    color: white;
}

.post-stat {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.post-stat i {
    font-size: 1.1rem;
}

.event-attendees {
    font-size: 0.8rem;
    color: var(--sage-green);
}

/* Empty State */
.empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--text-secondary);
}

.empty-state i {
    font-size: 4rem;
    opacity: 0.3;
    margin-bottom: 1rem;
    display: block;
}

.empty-state p {
    margin-bottom: 1.5rem;
}

/* Revenue Card */
.revenue-card {
    background: linear-gradient(135deg, var(--sage-green) 0%, var(--sage-dark) 100%);
    color: white;
}

.revenue-card .section-header h3 {
    color: white;
}

.revenue-content {
    color: white;
}

.revenue-total {
    text-align: center;
    margin-bottom: 1.5rem;
}

.revenue-total .currency {
    font-size: 0.9rem;
    opacity: 0.8;
}

.revenue-total h2 {
    font-size: 2.5rem;
    margin: 0.5rem 0;
    color: white;
}

.revenue-breakdown {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    margin-bottom: 1.5rem;
}

.revenue-item {
    display: flex;
    justify-content: space-between;
    padding: 0.75rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
}

/* Fans List */
.fans-list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
}

.fan-item {
    display: flex;
    gap: 1rem;
    align-items: center;
    padding: 0.75rem;
    border-radius: 10px;
    transition: background 0.3s ease;
}

.fan-item:hover {
    background: var(--pink-light);
}

.fan-avatar img {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
}

.avatar-default {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--pink);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
}

.fan-info h4 {
    margin: 0;
    font-size: 0.9rem;
    color: var(--brown);
}

.fan-info p {
    margin: 0;
    font-size: 0.8rem;
    color: var(--text-secondary);
}

/* Quick Links */
.quick-links-list {
    display: flex;
    flex-direction: column;
}

.quick-links-list a {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    color: var(--brown);
    text-decoration: none;
    border-radius: 8px;
    transition: background 0.3s ease;
}

.quick-links-list a:hover {
    background: var(--sage-light);
}

.quick-links-list i {
    font-size: 1.2rem;
    color: var(--sage-green);
}

/* Buttons */
.btn-block {
    width: 100%;
    justify-content: center;
}

/* Responsive */
@media (max-width: 968px) {
    .dashboard-grid {
        grid-template-columns: 1fr;
    }

    .dashboard-welcome {
        flex-direction: column;
        text-align: center;
    }

    .welcome-stats {
        justify-content: center;
    }

    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 640px) {
    .quick-actions {
        grid-template-columns: repeat(2, 1fr);
    }

    .dashboard-welcome h1 {
        font-size: 1.5rem;
    }

    .stat-pill {
        padding: 0.5rem 1rem;
        font-size: 0.9rem;
    }

    .quick-actions .action-card {
        padding: 1rem;
    }

    .quick-actions .action-card span {
        font-size: 0.9rem;
    }

    .stats-grid {
        grid-template-columns: 1fr;
    }

    .kyc-actions {
        flex-direction: column;
    }

    .kyc-actions .btn {
        width: 100%;
        justify-content: center;
    }
}
</style>
{% endblock %}

{% block content %}
<div class="celebrity-dashboard-container">
    <!-- Welcome Section -->
    <div class="dashboard-welcome">
        <div class="welcome-content">
            <h1>Welcome back, {{ user.get_full_name|default:user.username }}!</h1>
            <p>Your celebrity command center</p>
        </div>
        <div class="welcome-stats">
            <div class="stat-pill">
                <i class='bx bx-user'></i>
                <span>{{ total_followers|default:0 }} Followers</span>
            </div>
            <div class="stat-pill">
                <i class='bx bx-trending-up'></i>
                <span>{{ engagement_rate|default:0 }}% Engagement</span>
            </div>
            <div class="stat-pill">
                <i class='bx bx-dollar-circle'></i>
                <span>NPR {{ total_revenue|default:0 }}</span>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
        <a href="{% url 'create_post' %}" class="action-card">
            <i class='bx bxs-edit'></i>
            <span>Create Post</span>
        </a>
        <a href="{% url 'create_event' %}" class="action-card">
            <i class='bx bx-calendar-event'></i>
            <span>New Event</span>
        </a>
        <a href="{% url 'celebrity_analytics' %}" class="action-card">
            <i class='bx bx-bar-chart'></i>
            <span>View Analytics</span>
        </a>
        <a href="{% url 'payment_history' %}" class="action-card">
            <i class='bx bx-wallet'></i>
            <span>Payments</span>
        </a>
    </div>

    <!-- KYC Verification Status Panel -->
    {% if celebrity_profile %}
    <div class="kyc-status-panel">
        <div class="kyc-status-header">
            <h3><i class='bx bx-shield-check'></i> KYC Verification Status</h3>
            {% if celebrity_profile.verification_status == 'approved' %}
                <span class="kyc-status-badge kyc-approved">
                    <i class='bx bx-check-circle'></i> Verified
                </span>
            {% elif celebrity_profile.verification_status == 'pending' and celebrity_profile.needs_resubmission %}
                <span class="kyc-status-badge kyc-resubmission">
                    <i class='bx bx-refresh'></i> Resubmission Required
                </span>
            {% elif celebrity_profile.verification_status == 'pending' %}
                <span class="kyc-status-badge kyc-pending">
                    <i class='bx bx-time'></i> Under Review
                </span>
            {% elif celebrity_profile.verification_status == 'rejected' %}
                <span class="kyc-status-badge kyc-rejected">
                    <i class='bx bx-x-circle'></i> Rejected
                </span>
            {% else %}
                <span class="kyc-status-badge kyc-not-submitted">
                    <i class='bx bx-info-circle'></i> Not Submitted
                </span>
            {% endif %}
        </div>

        <div class="kyc-content">
            {% if celebrity_profile.verification_status == 'approved' %}
                <!-- Approved State -->
                <div class="kyc-message success">
                    <p><strong><i class='bx bx-badge-check'></i> Congratulations!</strong></p>
                    <p>Your celebrity profile has been verified. You now have access to all premium features and your profile will display a verification checkmark.</p>
                    {% if celebrity_profile.verification_date %}
                    <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted);">
                        Verified on {{ celebrity_profile.verification_date|date:"M d, Y" }}
                    </p>
                    {% endif %}
                </div>

            {% elif celebrity_profile.verification_status == 'pending' and celebrity_profile.needs_resubmission %}
                <!-- Resubmission Required State -->
                <div class="kyc-message warning">
                    <p><strong><i class='bx bx-refresh'></i> Additional Documents Required</strong></p>
                    <p>Our verification team needs additional documents to complete your KYC verification. Please upload the requested documents below.</p>
                    {% if celebrity_profile.verification_notes %}
                    <div class="kyc-remarks">
                        <h4><i class='bx bx-message-dots'></i> Required Documents</h4>
                        <p style="margin: 0; color: var(--text-primary);">{{ celebrity_profile.verification_notes }}</p>
                    </div>
                    {% endif %}
                </div>

                <div class="kyc-actions">
                    <a href="{% url 'celebrity_kyc_resubmit' %}" class="btn btn-warning">
                        <i class='bx bx-upload'></i> Upload Additional Documents
                    </a>
                    <a href="#" class="btn btn-outline" onclick="alert('Please contact support at support@mantra.com or call +977-XXX-XXXX'); return false;">
                        <i class='bx bx-support'></i> Contact Support
                    </a>
                </div>

            {% elif celebrity_profile.verification_status == 'pending' %}
                <!-- Pending Review State -->
                <div class="kyc-message warning">
                    <p><strong><i class='bx bx-time-five'></i> Verification Under Review</strong></p>
                    <p>Thank you for submitting your verification documents. Our team is currently reviewing your submission. You'll receive a notification once the review is complete.</p>
                    {% if celebrity_profile.document_submitted_at %}
                    <p style="margin-top: 0.5rem; font-size: 0.9rem; color: var(--text-muted);">
                        Submitted on {{ celebrity_profile.document_submitted_at|date:"M d, Y g:i A" }}
                    </p>
                    {% endif %}
                </div>
                <div style="background: var(--bg-light); padding: 1rem; border-radius: 8px; margin-top: 1rem;">
                    <p style="margin: 0; font-size: 0.9rem; color: var(--text-secondary);">
                        <i class='bx bx-info-circle'></i> Average review time: 2-3 business days
                    </p>
                </div>

            {% elif celebrity_profile.verification_status == 'rejected' %}
                <!-- Rejected State -->
                <div class="kyc-message danger">
                    <p><strong><i class='bx bx-error'></i> Verification Request Declined</strong></p>
                    <p>Unfortunately, your verification request could not be approved at this time. Please review the remarks below and resubmit your documents.</p>
                </div>

                {% if celebrity_profile.verification_notes %}
                <div class="kyc-remarks">
                    <h4><i class='bx bx-message-dots'></i> Rejection Remarks</h4>
                    <p style="margin: 0; color: var(--text-primary);">{{ celebrity_profile.verification_notes }}</p>
                </div>
                {% endif %}

                <div class="kyc-actions">
                    <a href="{% url 'celebrity_kyc_resubmit' %}" class="btn btn-primary">
                        <i class='bx bx-upload'></i> Resubmit Documents
                    </a>
                    <a href="#" class="btn btn-outline" onclick="alert('Please contact support at support@mantra.com or call +977-XXX-XXXX'); return false;">
                        <i class='bx bx-support'></i> Contact Support
                    </a>
                </div>

            {% else %}
                <!-- Not Submitted State -->
                <div class="kyc-message info">
                    <p><strong><i class='bx bx-info-circle'></i> Verification Required</strong></p>
                    <p>Complete your celebrity verification to unlock premium features, get a verification badge, and build trust with your fans.</p>
                </div>

                <div style="background: var(--bg-light); padding: 1.5rem; border-radius: 8px; margin-top: 1rem;">
                    <h4 style="margin: 0 0 1rem 0; color: var(--brown); font-size: 1rem;">
                        <i class='bx bx-list-check'></i> Required Documents:
                    </h4>
                    <ul style="margin: 0; padding-left: 1.5rem; color: var(--text-secondary);">
                        <li>Government-issued ID (Citizenship, Passport, or Driver's License)</li>
                        <li>Recent photograph (clear face photo)</li>
                        <li>Proof of celebrity status (awards, media articles, social media verification, etc.)</li>
                        <li>Optional: Additional supporting documents</li>
                    </ul>
                </div>

                <div class="kyc-actions">
                    <a href="{% url 'celebrity_kyc_upload' %}" class="btn btn-primary">
                        <i class='bx bx-upload'></i> Submit Documents
                    </a>
                </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Main Dashboard Grid -->
    <div class="dashboard-grid">
        <!-- Left Column: Main Content -->
        <div class="dashboard-main">
            <!-- Stats Overview -->
            <div class="section-card">
                <div class="section-header">
                    <h2><i class='bx bx-trending-up'></i> Performance Overview</h2>
                    <a href="{% url 'celebrity_analytics' %}" class="btn-link">View Details</a>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon followers">
                            <i class='bx bx-user'></i>
                        </div>
                        <div class="stat-info">
                            <h3>{{ total_followers|default:0 }}</h3>
                            <p>Total Followers</p>
                            <span class="stat-change positive">+{{ new_followers_this_week|default:0 }} this week</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon views">
                            <i class='bx bx-show'></i>
                        </div>
                        <div class="stat-info">
                            <h3>{{ total_views|default:0 }}</h3>
                            <p>Profile Views</p>
                            <span class="stat-change">Last 30 days</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon engagement">
                            <i class='bx bx-heart'></i>
                        </div>
                        <div class="stat-info">
                            <h3>{{ total_likes|default:0 }}</h3>
                            <p>Total Likes</p>
                            <span class="stat-change">All time</span>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-icon posts">
                            <i class='bx bx-news'></i>
                        </div>
                        <div class="stat-info">
                            <h3>{{ total_posts|default:0 }}</h3>
                            <p>Total Posts</p>
                            <span class="stat-change">Published</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Posts -->
            <div class="section-card">
                <div class="section-header">
                    <h2><i class='bx bx-news'></i> Recent Posts</h2>
                    <a href="{% url 'create_post' %}" class="btn-link">Create New</a>
                </div>

                <div class="posts-list">
                    {% if recent_posts %}
                        {% for post in recent_posts %}
                        <div class="post-item">
                            <div class="post-content">
                                <p>{{ post.content|truncatewords:20 }}</p>
                                <span class="post-time">{{ post.created_at|timesince }} ago</span>
                            </div>
                            <div class="post-stats">
                                <span><i class='bx bx-heart'></i> {{ post.likes_count|default:0 }}</span>
                                <span><i class='bx bx-comment'></i> {{ post.comments_count|default:0 }}</span>
                                <span><i class='bx bx-share'></i> {{ post.shares_count|default:0 }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <i class='bx bx-news'></i>
                            <p>No posts yet! Share your first post with your fans.</p>
                            <a href="{% url 'create_post' %}" class="btn btn-primary">
                                <i class='bx bx-plus'></i> Create Post
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Upcoming Events -->
            <div class="section-card">
                <div class="section-header">
                    <h2><i class='bx bx-calendar'></i> Upcoming Events</h2>
                    <a href="{% url 'event_create' %}" class="btn-link">Create Event</a>
                </div>

                <div class="events-list">
                    {% if upcoming_events %}
                        {% for event in upcoming_events %}
                        <div class="event-item">
                            <div class="event-icon">
                                <i class='bx bx-calendar-event'></i>
                            </div>
                            <div class="event-info">
                                <h4>{{ event.title }}</h4>
                                <p>{{ event.start_datetime|date:"M d, Y â€¢ g:i A" }}</p>
                                <span class="event-attendees">{{ event.registered_count|default:0 }} registered</span>
                            </div>
                            <a href="{% url 'event_detail' event.slug %}" class="btn btn-sm btn-outline">View</a>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <i class='bx bx-calendar-x'></i>
                            <p>No upcoming events. Create one to engage with your fans!</p>
                        </div>
                    {% endif %}
                </div>
            </div>

            <!-- Fan Posts Feed -->
            <div class="section-card">
                <div class="section-header">
                    <h2><i class='bx bx-user-voice'></i> Top Fans Feed</h2>
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs" style="padding: 0 1.5rem; margin-bottom: 1rem;">
                    <a href="?fan_filter=all" class="filter-tab {% if fan_filter == 'all' %}active{% endif %}">
                        <i class='bx bx-group'></i> All Followers
                    </a>
                    <a href="?fan_filter=subscribers" class="filter-tab {% if fan_filter == 'subscribers' %}active{% endif %}">
                        <i class='bx bx-crown'></i> Subscribers
                    </a>
                    <a href="?fan_filter=purchasers" class="filter-tab {% if fan_filter == 'purchasers' %}active{% endif %}">
                        <i class='bx bx-shopping-bag'></i> Merch Buyers
                    </a>
                    <a href="?fan_filter=event_attendees" class="filter-tab {% if fan_filter == 'event_attendees' %}active{% endif %}">
                        <i class='bx bx-calendar'></i> Event Attendees
                    </a>
                </div>

                <div class="fan-posts-list">
                    {% if fan_posts %}
                        {% for post in fan_posts %}
                        <div class="fan-post-item">
                            <div class="post-author">
                                {% if post.author.profile_picture %}
                                <img src="{{ post.author.profile_picture.url }}" alt="{{ post.author.username }}" class="author-avatar">
                                {% else %}
                                <div class="author-avatar" style="background: var(--pink-light); display: flex; align-items: center; justify-content: center;">
                                    <i class='bx bx-user' style="color: var(--pink);"></i>
                                </div>
                                {% endif %}
                                <div class="author-info">
                                    <strong><a href="{% url 'profile' post.author.username %}">{{ post.author.username }}</a></strong>
                                    <span class="post-time">{{ post.created_at|timesince }} ago</span>
                                </div>
                            </div>
                            <div class="post-content">
                                <p>{{ post.content|truncatewords:30 }}</p>
                                {% if post.image %}
                                <img src="{{ post.image.url }}" alt="Post image" class="post-image">
                                {% endif %}
                            </div>
                            <div class="post-actions">
                                <a href="{% url 'post_detail' post.id %}" class="post-action-btn">
                                    <i class='bx bx-show'></i> View
                                </a>
                                <span class="post-stat"><i class='bx bx-heart'></i> {{ post.likes_count|default:0 }}</span>
                                <span class="post-stat"><i class='bx bx-comment'></i> {{ post.comments_count|default:0 }}</span>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <div class="empty-state">
                            <i class='bx bx-user-x'></i>
                            <p>No posts from {% if fan_filter == 'subscribers' %}subscribers{% elif fan_filter == 'purchasers' %}merch buyers{% elif fan_filter == 'event_attendees' %}event attendees{% else %}your fans{% endif %} yet.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Right Column: Sidebar -->
        <div class="dashboard-sidebar">
            <!-- Revenue Card -->
            <div class="section-card revenue-card">
                <div class="section-header">
                    <h3><i class='bx bx-wallet'></i> Revenue</h3>
                </div>
                <div class="revenue-content">
                    <div class="revenue-total">
                        <span class="currency">NPR</span>
                        <h2>{{ total_revenue|default:0 }}</h2>
                    </div>
                    <div class="revenue-breakdown">
                        <div class="revenue-item">
                            <span>This Month</span>
                            <strong>NPR {{ revenue_this_month|default:0 }}</strong>
                        </div>
                        <div class="revenue-item">
                            <span>Pending</span>
                            <strong>NPR {{ pending_revenue|default:0 }}</strong>
                        </div>
                    </div>
                    <a href="{% url 'payment_history' %}" class="btn btn-primary btn-block">
                        <i class='bx bx-dollar-circle'></i> View Payments
                    </a>
                </div>
            </div>

            <!-- Official Fan Club -->
            {% if official_fanclub %}
            <div class="section-card" style="background: linear-gradient(135deg, rgba(255, 182, 193, 0.1) 0%, rgba(135, 169, 107, 0.1) 100%); border: 2px solid var(--pink);">
                <div class="section-header">
                    <h3><i class='bx bx-group'></i> Your Fan Club</h3>
                </div>
                <div style="text-align: center; padding: 1rem 0;">
                    {% if official_fanclub.icon %}
                    <img src="{{ official_fanclub.icon.url }}" alt="{{ official_fanclub.name }}" style="width: 80px; height: 80px; border-radius: 50%; object-fit: cover; margin-bottom: 1rem; border: 3px solid var(--pink);">
                    {% else %}
                    <div style="width: 80px; height: 80px; border-radius: 50%; background: var(--pink); color: white; display: flex; align-items: center; justify-content: center; margin: 0 auto 1rem; font-size: 2rem; font-weight: 700;">
                        <i class='bx bx-group'></i>
                    </div>
                    {% endif %}
                    <h4 style="margin: 0 0 0.5rem 0; color: var(--brown);">{{ official_fanclub.name }}</h4>
                    <div style="display: flex; justify-content: center; gap: 1.5rem; margin: 1rem 0; padding: 1rem 0; border-top: 1px solid var(--border); border-bottom: 1px solid var(--border);">
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--pink);">{{ fanclub_members }}</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted);">Members</div>
                        </div>
                        <div>
                            <div style="font-size: 1.5rem; font-weight: 700; color: var(--sage-green);">{{ fanclub_messages|default:0 }}</div>
                            <div style="font-size: 0.85rem; color: var(--text-muted);">Messages</div>
                        </div>
                    </div>
                    <p style="margin: 0.5rem 0; color: var(--text-secondary); font-size: 0.9rem;">{{ official_fanclub.description|truncatewords:15 }}</p>
                </div>
                <div style="display: flex; gap: 0.5rem;">
                    {% if official_fanclub.group_chat %}
                    <a href="{% url 'conversation' official_fanclub.group_chat.id %}" class="btn btn-primary" style="flex: 1; justify-content: center;">
                        <i class='bx bx-message'></i> Group Chat
                    </a>
                    {% endif %}
                    <a href="{% url 'edit_fanclub' official_fanclub.slug %}" class="btn btn-outline" style="flex: 1; justify-content: center;">
                        <i class='bx bx-edit'></i> Edit
                    </a>
                </div>
            </div>
            {% endif %}

            <!-- Top Fans -->
            <div class="section-card">
                <div class="section-header">
                    <h3><i class='bx bx-star'></i> Top Fans</h3>
                </div>
                <div class="fans-list">
                    {% if top_fans %}
                        {% for fan in top_fans %}
                        <div class="fan-item">
                            <div class="fan-avatar">
                                {% if fan.profile_picture %}
                                    <img src="{{ fan.profile_picture.url }}" alt="{{ fan.username }}">
                                {% else %}
                                    <div class="avatar-default">{{ fan.username.0|upper }}</div>
                                {% endif %}
                            </div>
                            <div class="fan-info">
                                <h4>{{ fan.get_full_name|default:fan.username }}</h4>
                                <p>{{ fan.interaction_count|default:0 }} interactions</p>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="text-muted text-center">No fan data yet</p>
                    {% endif %}
                </div>
            </div>

            <!-- Quick Links -->
            <div class="section-card">
                <div class="section-header">
                    <h3><i class='bx bx-link'></i> Quick Links</h3>
                </div>
                <div class="quick-links-list">
                    <a href="{% url 'profile' user.username %}">
                        <i class='bx bx-user'></i> View Profile
                    </a>
                    <a href="{% url 'edit_profile' %}">
                        <i class='bx bx-edit'></i> Edit Profile
                    </a>
                    <a href="{% url 'merchandise_list' %}">
                        <i class='bx bx-shopping-bag'></i> Merchandise
                    </a>
                    <a href="{% url 'fanclub_list' %}">
                        <i class='bx bx-group'></i> Fanclubs
                    </a>
                    <a href="{% url 'settings' %}">
                        <i class='bx bx-cog'></i> Settings
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}